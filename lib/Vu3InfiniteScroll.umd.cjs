(function(n,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.Vu3InfiniteScroll={},n.Vue))})(this,function(n,e){"use strict";const z=e.defineComponent({__name:"infinite-scroll",props:{rowKey:{type:String,default:"id"},listData:{type:Array,default:()=>[]},scrollOption:{type:Object}},emits:["rowScrollEnd"],setup(i,{expose:E,emit:g}){const l=i,W={dir:"up",step:.5,singleDataCount:0,singleStepDis:0,hoverStop:!0,waitTime:1e3,autoPlay:!0,loop:!0,slideIndex:0},b=e.ref(""),p=e.ref(0),C=e.ref(!1),s=e.ref(0),u=e.ref(0),T=e.ref(0),A=e.ref(0),O=e.ref(0),P=e.ref(0),D=e.ref(),d=e.ref(),v=e.ref(),m=e.ref(),y=e.ref(),$=e.useSlots(),_=e.computed(()=>!!$["custom-render"]),c=e.computed(()=>["right","left"].includes(a.value.dir)),B=e.computed(()=>{var r;const t=(r=v.value)==null?void 0:r.querySelector(".scroll-row-item");return _.value&&a.value.singleDataCount>0?a.value.singleDataCount*(t?c.value?t.offsetWidth:t.offsetHeight:0):a.value.singleStepDis}),h=e.computed(()=>{let t=a.value.step;const r=B.value;return r>0&&r%t>0&&console.error("\u5982\u679C\u8BBE\u7F6E\u4E86\u5355\u6B65\u6EDA\u52A8,step\u9700\u662F\u5355\u6B65\u5927\u5C0F\u7684\u7EA6\u6570,\u5426\u5219\u65E0\u6CD5\u4FDD\u8BC1\u5355\u6B65\u6EDA\u52A8\u7ED3\u675F\u7684\u4F4D\u7F6E\u662F\u5426\u51C6\u786E\u3002~~~~~"),t}),M=e.ref(l.listData);e.watch(l.listData,t=>{x(),M.value=t,V()},{flush:"post"});const a=e.computed(()=>({...W,...l.scrollOption})),j=e.computed(()=>({transform:`translate(${u.value}px,${s.value}px)`,transition:"all ease-in 0ms",overflow:"hidden"})),H=()=>{const{dir:t,waitTime:r,autoPlay:f}=a.value,w=O.value/2,k=P.value/2;switch(t){case"up":Math.abs(s.value)>=k&&(s.value=0),s.value-=h.value;break;case"down":s.value>=0&&(s.value=k*-1),s.value+=h.value;break;case"left":Math.abs(u.value)>=w&&(u.value=0),u.value-=h.value;break;case"right":u.value>=0&&(u.value=w*-1),u.value+=h.value;break}if(y.value&&clearTimeout(y.value),B.value>0)if(Math.abs(c.value?u.value:s.value)%B.value<h.value){(!b.value||b.value===t)&&(["up","right"].includes(t)?p.value-=1:p.value+=1),b.value=t;let o=p.value;const F=l.listData.length*2;o<=0?(p.value=F,o=F-1):(o>F&&(p.value=o=1),o-=1),g("rowScrollEnd",l.listData[o%l.listData.length]),y.value=setTimeout(()=>{f&&S()},r)}else S();else S()},S=()=>{m.value&&cancelAnimationFrame(m.value||""),m.value=requestAnimationFrame(H)},V=async()=>{if(await e.nextTick(),!D.value||!d.value||!v.value)return;const{loop:t,autoPlay:r}=a.value;A.value=D.value.offsetHeight,T.value=D.value.offsetWidth;const f=v.value.offsetWidth;if(c.value?T.value<=f:A.value<=v.value.offsetHeight){if(_.value&&a.value.loop){const k=l.listData.map(o=>o instanceof Object?{...o,[l.rowKey]:o[l.rowKey]?`copy_${o[l.rowKey]}`:o[l.rowKey]}:o);M.value=[...l.listData,...k]}else C.value=t;await e.nextTick(),c.value&&t&&(d.value.style.width=f*2+"px"),P.value=d.value.offsetHeight,O.value=d.value.offsetWidth,r&&S()}},x=()=>{y.value&&clearTimeout(y.value),m.value&&cancelAnimationFrame(m.value||"")},q=()=>{a.value.autoPlay&&a.value.hoverStop&&x()},N=()=>{a.value.autoPlay&&a.value.hoverStop&&S()};return E({perMove:H}),e.onMounted(()=>{p.value=a.value.slideIndex,V()}),e.onBeforeMount(()=>{x()}),(t,r)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"overflowWrap",ref:D,class:"infinite-scroll-wrapper"},[e.createElementVNode("div",{class:"scroll-wrapper",ref_key:"scrollWrap",ref:d,style:e.normalizeStyle(e.unref(j)),onMouseenter:q,onMouseleave:N},[e.createElementVNode("div",{ref_key:"originWrap",ref:v,class:e.normalizeClass(["origin-wrapper",e.unref(c)&&"horizontal"]),style:e.normalizeStyle(e.unref(c)?{float:"left"}:{})},[e.unref(_)?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(M.value,(f,w)=>(e.openBlock(),e.createElementBlock("div",{key:f[i.rowKey]||w,class:"scroll-row-item"},[e.renderSlot(t.$slots,"custom-render",{item:f},void 0,!0)]))),128)):e.renderSlot(t.$slots,"default",{key:1},void 0,!0)],6),!e.unref(_)&&C.value?(e.openBlock(),e.createElementBlock("div",{key:0,class:"copy-wrapper",style:e.normalizeStyle(e.unref(c)?{float:"left"}:{})},[e.renderSlot(t.$slots,"default",{},void 0,!0)],4)):e.createCommentVNode("",!0)],36)],512))}}),L="",I=((i,E)=>{const g=i.__vccOpts||i;for(const[l,W]of E)g[l]=W;return g})(z,[["__scopeId","data-v-fd82bc3b"]]),K={install:i=>{i.component("Vue3InfiniteScroll",I)}};n.Vue3InfiniteScroll=I,n.default=K,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
